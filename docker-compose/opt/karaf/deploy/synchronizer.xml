<?xml version="1.0" encoding="UTF-8" standalone="no"?><!--
  ~  Copyright 2017 - InCadence Strategic Solutions Inc., All Rights Reserved
  ~
  ~  Notwithstanding any contractor copyright notice, the Government has Unlimited
  ~  Rights in this work as defined by DFARS 252.227-7013 and 252.227-7014.  Use
  ~  of this work other than as specifically authorized by these DFARS Clauses may
  ~  violate Government rights in this work.
  ~
  ~  DFARS Clause reference: 252.227-7013 (a)(16) and 252.227-7014 (a)(16)
  ~  Unlimited Rights. The Government has the right to use, modify, reproduce,
  ~  perform, display, release or disclose this computer software and to have or
  ~  authorize others to do so.
  ~
  ~  Distribution Statement D. Distribution authorized to the Department of
  ~  Defense and U.S. DoD contractors only in support of U.S. DoD efforts.
  ~
  --><blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0" xmlns:http="http://cxf.apache.org/transports/http/configuration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0             http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd             http://cxf.apache.org/transports/http/configuration             http://cxf.apache.org/schemas/configuration/http-conf.xsd">

    <bean class="com.incadencecorp.coalesce.synchronizer.service.SynchronizerService" destroy-method="stop" id="service" init-method="start">
        <property name="drivers">
            <array>
                <ref component-id="myDriver"/>
            </array>
        </property>
    </bean>

    <bean class="com.incadencecorp.coalesce.synchronizer.service.drivers.IntervalDriverImpl" id="myDriver" init-method="setup">
        <property name="name" value="Driver"/>
        <property name="scan" ref="myScanner"/>
        <property name="operations">
            <array>
                <ref component-id="myOperation"/>
            </array>
        </property>
        <property name="properties">
            <map>
                <entry key="com.incadencecorp.driver.interval" value="59"/>
                <entry key="com.incadencecorp.driver.intervalunits" value="SECONDS"/>
                <entry key="com.incadencecorp.driver.threads" value="100"/>
            </map>
        </property>
    </bean>

    <bean class="com.incadencecorp.coalesce.synchronizer.service.scanners.AfterUploadedToServerScan" id="myScanner" init-method="setup">
        <property name="name" value="Uploaded to ServerScan"/>
        <property name="source" ref="derby"/>
        <property name="properties">
            <map>
                <entry key="com.incadencecorp.scanners.max" value="50"/>
                <entry key="com.incadencecorp.scanners.pattern" value=" yyyy-MM-dd HH:mm:ss.SSS"/>
            </map>
        </property>
 <property name="propertyLoader">
            <bean class="com.incadencecorp.coalesce.framework.PropertyLoader">
                <argument ref="connector"/>
                <argument value="sql-config.properties"/>
            </bean>
        </property>
    </bean>

    <bean class="com.incadencecorp.coalesce.synchronizer.service.operations.CopyOperationImpl" id="myOperation">
        <property name="name" value="Operation"/>
        <property name="source" ref="derby"/>
        <property name="target">
            <array>
                <ref component-id="rest"/>
            </array>
        </property>
        <property name="properties">
            <map>
                <entry key="com.incadencecorp.operations.window" value="50"/>
            </map>
        </property>
    </bean>

    <!-- ========================== -->
    <!-- Persisters -->
    <!-- ========================== -->
    <bean class="com.incadencecorp.coalesce.framework.persistance.sql.impl.SQLSearchPersisterImpl" id="derby">
        <argument>
            <map>
                <entry key="asid.dbServerName" value="192.168.75.1"/>
                <entry key="asid.dbServerPort" value="1433"/>
                <entry key="asid.database" value="IdentityHubDatabase"/>
                <entry key="asid.dbUser" value="idhub_user"/>
                <entry key="asid.dbPassword" value="Passw0rd"/>
            </map>
        </argument>
    </bean>

    

    <bean class="com.incadencecorp.coalesce.framework.persistance.elasticsearch.ElasticSearchPersistorSearch" id="rest">
        <argument>
            <map>
                <entry key="elastic.isAuthoritative" value="true"/>
                <entry key="elastic.clustername" value="elasticsearch"/>
                <entry key="elastic.hosts" value="192.168.75.1:9300"/>
                <entry key="elastic.http.host" value="192.168.75.1"/>
                <entry key="elastic.http.port" value="9300"/>
                <entry key="elastic.datastore.cache.enabled" value="false"/>
            </map>
        </argument>
    </bean>

<bean class="com.incadencecorp.unity.common.connectors.FilePropertyConnector" id="connector"/></blueprint>