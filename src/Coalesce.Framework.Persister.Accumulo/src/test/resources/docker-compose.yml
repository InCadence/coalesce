version: "2"

volumes:
  db-backups:
  geoserver-data:

networks:
  estest:
    driver: bridge

services:
    db:
      image: kartoza/postgis:10.0-2.4
      hostname: postgis
      volumes:
        #- ./pg/postgres_data:/var/lib/postgresql
        - db-backups:/backups
      ports:
        - "25432:5432"
      networks:
        - estest
      environment:
        - USERNAME=docker
        - PASS=docker
        - ALLOW_IP_RANGE=172.20.0.0/24
      restart: unless-stopped
    geoserver:
      image: eeacms/elasticgeo #kartoza/geoserver:2.12.0
      hostname: geoserver 
      volumes:
        - geoserver-data:/opt/geoserver/data_dir
      ports:
        - "8080:8080"
      networks:
        - estest
      links:
        - db:db
      restart: unless-stopped
      user: root
    accumulo:
        image: ccruz09/accumulo
        container_name: accumulo-instance
        ports:
            - "9999:9999"
            - "9997:9997"
            - "50095:50095"
        restart: unless-stopped
    #kibana5:
#      image: docker.elastic.co/kibana/kibana:5.4.0
#      container_name: rbcf-kibana
#      environment:
#        - ACCUMULO_URL=http://accumulo:9200
#      ports:
#        - "5601:5601"
#      depends_on:
#        - "accumulo"
#      restart: unless-stopped
#
